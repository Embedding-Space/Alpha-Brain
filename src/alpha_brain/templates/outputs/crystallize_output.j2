Current time: {{ current_time | format_time_full }}

Analysis mode: {{ mode }}
{% if query != "recent memories" %}Query: {{ query }}
{% endif %}{% if interval %}Interval: {{ interval }}
{% endif %}
Memories analyzed: {{ filtered_count }}{% if total_count %} (of {{ total_count }} total){% endif %}

Found {{ total_clusters_found }} cluster{{ total_clusters_found | pluralize }} of related memories.
{% if filtered_clusters > 0 %}(Filtered out {{ filtered_clusters }} cluster{{ filtered_clusters | pluralize }} with < {{ min_cluster_size }} memories){% endif %}

{% if candidates %}
## Memory Clusters

{% for candidate in candidates %}
---
### Cluster {{ loop.index }}
**{{ candidate.memory_count }} memories** • Similarity: {{ "%.3f"|format(candidate.similarity) }}  
**Score**: {{ "%.3f"|format(candidate.interestingness_score) if candidate.interestingness_score else "N/A" }}  
{% if candidate.interestingness_vector %}**Components**: Size={{ "%.2f"|format(candidate.interestingness_vector[0]) }} • Tightness={{ "%.2f"|format(candidate.interestingness_vector[1]) }} • Focus={{ "%.2f"|format(candidate.interestingness_vector[2]) }} • Density={{ "%.2f"|format(candidate.interestingness_vector[3]) }}{% endif %}  
Time span: {{ candidate.oldest }} to {{ candidate.newest }} ({{ "%.1f"|format(candidate.time_span_days) if candidate.time_span_days else "0" }} days)

{% if candidate.centroid %}**Most representative memory ({{ candidate.centroid.timestamp }}):**
{{ candidate.centroid.content }}

*Centroid distance: {{ "%.3f"|format(candidate.centroid.distance) }}*
{% else %}**No centroid memory available for this cluster**
{% endif %}

To analyze this cluster in depth, use: `analyze_cluster(cluster_number={{ loop.index }})`

{% endfor %}
{% else %}
{% if filtered_count == 0 %}
No memories found{% if query != "recent memories" %} for "{{ query }}"{% endif %}{% if interval %} in {{ interval }}{% endif %}.
{% else %}
No clusters found from {{ filtered_count }} memories.
Try adjusting your filters or lowering the clustering threshold.
{% endif %}
{% endif %}